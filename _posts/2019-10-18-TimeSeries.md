---
layout: post
title: "시계열분석 기초"
author: "JeonghyunGan"
categories: [DataScienceLab, Blog]
---

데이콘 프로젝트를 진행하면서 난생 처음 시계열분석을 해야 할 일이 생겼는데, 하는 김에 정리~

## 1. 기본적인 개념들

1. 시계열(time series)

    시계열이란 실제 데이터로 얻어지는 확률과정이다. 즉 우리가 사는 세계에서 얻어진 시계열 자료는 확률과정에서 뽑혀나온 샘플이라고 가정한다. 시계열분석은 독립변수가 자기상관성을 갖는다는 것, 즉 앞의 데이터가 뒤의 데이터에 영향을 미친다는 것을 전제한다.

2. 정상성(stationarity)

    시계열 데이터의 평균과 분산이 일정하고 공분산도 시차에만 의존할 뿐 특정 시점에는 의존하지 않을 경우 정상성을 갖는다고 한다. 데이터가 정상성을 가진다는 것은 평균과 분산이 안정되어 분석하기 쉽다는 의미이고, 사실상 시계열분석을 적용하기 위한 필수 조건이다. 따라서 정상성을 가지지 않는 데이터에는 정상성을 갖도록 만드는 전처리를 하게 된다. 보통 평균이 일정하지 않으면 차분을 취하고, 분산이 일정하지 않으면 변환을 취한다.

3. 백색잡음 (white noise)

    $i.i.d$(independent indectically distributed)한 확룰변수$e_t$들의 수열 $\{e_t\}^\infty_{t=1}$를 백색잡음이라고 한다.

4. 이동평균과정(moving average process)

    백색잡음 $\{e_t\}_{t \in N}$에 대해 $Y_t := e_t - {\theta}e_{t-1} - {\theta}_2e_{t-2} - ... - {\theta}_qe_{t-q}$와 같이 정의된 $\{Y_t\}_{t\in N}$를 q차 이동평균과정 $MA(q)$라 한다. 이동평균은 하루하루의 극단적인 변화 대신 평균을 통해 전반적인 추세를 파악하는데 유용하다. 즉 어떤 변수에 국소적인 변동이 적다면 이동평균을 보는 의미가 없다. 이동평균과정은 데이터의 정상성을 필요로 한다.

5. 자기회귀과정(autoregressive process)

    백색잡음 $\{e_t\}_{t \in N}$에 대해 $Y_t := {\phi}Y_{t-1} - {\phi}_2Y_{t-2} - ... - {\phi}_pY_{t-p} + e_t$와 같이 정의된 $\{Y_t\}_{t\ in N}$를 q차 자기회귀과정 $AR(p)$라 한다. $AR(p)$를 자기회귀과정이라고 부르는 이유는 이전 시점의 자기 자신을 독립변수로 놓은 회귀식의 모양을 갖기 때문이다. 당연히 변수들끼리의 독립성을 가정하지 않는다. 또한 정상성을 필요로 하지도 않는다.

6. 차분(difference)


    1. 연산자 B(Backshift)를 $BY_t = Y_{t-1}$로 정의한다.

    2. 연산자 $\nabla$(차분)을 ${\nabla}Y_t:=1-BY_t$ 그리고 ${\nabla}^{r+1}={\nabla}({\nabla}^rY_t)$와 같이 정의한다.

    즉 차분이란 현시점의 값에서 이전 시점의 값을 빼는 것이다. 시계열분석에서 차분이 필요한 이유는 트렌드가 있는 데이터를 다루 때 편리하기 때문이다. 트렌드란 데이터의 값이 일정 기간동안 증가하거나 감소하는 경향을 말하는데, 트렌드가 존재하는 경우 정상성에 문제가 생긴다. 따라서 트렌드가 존재한다면 적절하게 차분을 취해 데이터가 정상성을 갖도록 만드는 전처리가 필요하다. 보통 디키-풀러 테스트를 사용해서 차분이 필요한지 여부를 판단한다. R에서 차분은 `diff()` 함수를 사용해서 구할 수 있다.

7. 변환(transformation)

    시간이 흐르면서 분산이 커지는 경우는 분산을 일정하게 하고 정상성을 얻기 위해서 변환을 한다. 루트나 로그는 값이 클수록 줄어드는 양이 많기 때문에 자주 사용된다. 분산이 줄어드는 경우에는 데이터의 추이가 특정 점으로 수렴한다는 의미이므로 시계열분석을 적용할 필요가 없다. 보통 박스-콕스 변환(멱변환, power transformation)의 가설검정을 이용하여 변환이 필요한지 여부를 판단한다.

## 2. 대표적인 모델들

1. ARMA(Auto Regression Moving Average)

    백색잡음 $\{e_t\}_{t\in N}$에 대해 $Y_t := {\phi}Y_{t-1} - {\phi}_2Y_{t-2} - ... - {\phi}_pY_{t-p} + e_t - {\theta}e_{t-1} - {\theta}_2e_{t-2} - ... - {\theta}_qe_{t-q}$와 같이 정의된 $\{Y_t\}_{t\in N}$를 (p,q)차 자기회귀과정 $ARMA(p,q)$라 한다. ARMA 모형은 단순히 이동평균과정과 자기회귀과정을 이어붙인 모양이다.

2. ARIMA(Auto Regression Integrated Moving Average)

    백색잡음 $\{e_t\}_{t \in N}$에 대해 ${\nabla}^dY_t := {\sum}^p_{i=1}{\phi}_i{\nabla}^dY_{t-i}+e_t-{\sum}^q_{i=1}{\phi}_ie_{t-i}$ 와 같이 정의된 $\{Y_t\}_{t \in N}$을 (p,d,q)차 아리마 과정 $ARIMA(p,d,q)$라고 한다. 즉 ARMA 모형에서 $Y_t$를 차분값인 ${\nabla}^dY_t$로 바꾼 모형이다. d번의 차분을 통해 정상성을 얻은 데이터를 ARMA 모형으로 분석한다고 보면 된다.

3. Seasonal ARIMA

    1. ${\nabla}_sY_t:=Y_t-Y_{t-s}$와 같이 정의된 오퍼레이터 ${\nabla}_s$를 계절형 차분이라 한다.

    2. $W_t:={\nabla}^d{\nabla}^D_sY_t$와 같이 정의된 $\{W_t\}_{t \in N}$가 $ARMA(P,Q)$이고, $\{Y_t\}_{t \in N}$이 $ARMA(p,q)$이면, $\{Y_t\}_{t \in N}$는 계절형 아리마 과정 $ARIMA(p,d,q) {\times} (P,D,Q)_s$ 라고 한다. 계절성이란 당연히 계절에만 연관된 필요는 없으며, 일정한 주기를 가지고 돌아오는 성질이 있다면 적용 가능하다. 개념적으로는 아리마 과정의 아리마 과정이라고 생각하면 되고, 그냥 더 큰 흐름이 있다 정도로만 받아들여도 무방하다.
