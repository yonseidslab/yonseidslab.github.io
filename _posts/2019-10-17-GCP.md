---
layout: post
title: "구글 클라우드: Rstudio 서버 구축"
author: "JeonghyunGan"
categories: [DataScienceLab, Blog]
---

요즘은 R을 기반으로 데이콘 프로젝트를 진행하는 중인데, 데이터가 노트북으로 감당하기 어려운 수준이라 클라우드 환경을 이용하게 되었다. 클라우드에서 주피터는 사용해본 적이 있는데, 우분투에도 익숙하지 않을뿐더러 Rstudio 서버를 구축해보는 것은 처음이라 어렵기는 했다. 전체적인 흐름은 [이 블로그](https://su2cstar.github.io/gcp/2019/03/28/Jupyter-Notebook-and-RStudio-on-GCP.html)를 참고하였다. 누구나 따라할 수 있을 정도로 쉽게 쓰여있지만, 사실 처음 따라할 때 다른 운영체제로 VM을 만들고 따라하다가 시간을 많이 낭비했다. 잘 모르면 그냥 글에 쓰여있는대로 Ubuntu 16.04 LTS를 사용하도록 하자. Ubuntu 16.04 LTS 운영체제에서 Rstudio 서버를 구축하는 데까지는 쉽게 성공을 했는데, 로그인 과정에서 얼을 많이 타고 tidyverse 등 패키지 구성에 애를 많이 먹은 것 같다. 주로 우분투 운영체제에 익숙하지 않아서 겪었던 시행착오들인데, 익숙해지면 괜찮을 것 같다. 다시 공부한다는 생각으로 과정을 정리해둔다.

![Rserver](/assets/article_images/rserver.png)
[열심히 훈련중인 랜덤포레스트]

## 1. 클라우드에서 Virtual Machine 생성

구글 클라우드 플랫폼 콘솔에서 우측 토글바를 열어 Compute Engine > VM인스턴스를 선택해 새로운 인스턴스를 만든다. 한번 잘 만들어두면 오래오래 쓸테니 쓸만한 사양으로 맞춰보자. 아시아 근처 지역을 선택하고, 원하는 사양을 세팅해준다. 아마 아시아 지역은 CPU를 8개까지밖에 못 쓰게 되어있던 것 같은데, 개인적으로는 더 많이 쓸 이유가 없어서 아쉬움은 없지만 필요하신 분들은 아시아가 아닌 다른 곳에 서버를 구축해야 할지도 모르겠다. CPU 8개에 52GB 메모리를 달았는데 한 시간 사용료가 0.425달러다. 피씨방 가는거랑 비슷한 가격인데 서버 하루종일 돌릴 것도 아니고 나쁘지 않은 것 같다. 방화벽은 일단 잘 몰라서 HTTP, HTTPS 모두 허용해줬는데, 아시는 분들은 알아서 설정하시면 될 것 같다.

![VM](/assets/article_images/VM.png)

## 2. 인스턴스에 접속, Rstudio 서버 구축

VM을 만들고 가동을 시작하면 SSH룰 통해서 접속이 가능하다. 활성화된 인스턴스에서 SSH를 클릭하면 터미널을 사용할 수 있다. 이 터미널을 가지고 Rstudio 서버를 구축하면 된다. 이 과정은 위에서 언급한 블로그에 너무나 잘 나와있으므로 생략한다. 만약 우분투 사용자의 패스워드가 등록되어있지 않다면 passwd username 명령어를 통해서 비밀번호를 설정해주어야 로그인이 가능한 것 같다(맨 처음 생성한 root 비밀번호와 다른 것인듯?). 아무튼 정상적으로 사용자 이름과 비밀번호를 가지고 있다면, http:외부 아이피:8787 주소로 접속해서 등록해둔 username과 비밀번호를 가지고 로그인하면 된다. 외부 아이피는 VM을 중지했다가 재시작할 때마다 갱신되므로, 계속해서 확인해줘야 한다. 외부 아이피를 고정하는 방법도 있긴 한데, 나중에 해보고 다시 업데이트하겠다. 끝~

![SSH](/assets/article_images/SSH.png)
